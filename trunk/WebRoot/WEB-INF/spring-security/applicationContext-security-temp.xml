<http>
	<custom-filter position="FORM_LOGIN_FILTER" ref="myAuthFilter" />
	<session-management
		session-authentication-strategy-ref="sas" />
</http>
<beans:bean id="myAuthFilter"
	class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
	<beans:property name="sessionAuthenticationStrategy"
		ref="sas" />
	<beans:property name="authenticationManager" ref="authenticationManager" />
</beans:bean>
<beans:bean id="sas"
	class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
	<beans:constructor-arg name="sessionRegistry"
		ref="sessionRegistry" />
	<beans:property name="maximumSessions" value="1" />
</beans:bean>








<http>
	<custom-filter position="CONCURRENT_SESSION_FILTER" ref="concurrencyFilter" />
	<custom-filter position="AUTHENTICATION_PROCESSING_FILTER"
		ref="myAuthFilter" />
	<session-management
		session-authentication-strategy-ref="sas" />
</http>
<beans:bean id="concurrencyFilter"
	class="org.springframework.security.web.authentication.concurrent.ConcurrentSessionFilter">
	<beans:property name="sessionRegistry" ref="sessionRegistry" />
	<beans:property name="expiredUrl" value="/session-expired.htm" />
</beans:bean>
<beans:bean id="myAuthFilter"
	class="org.springframework.security.web.authentcation.UsernamePasswordAuthenticationFilter">
	<beans:property name="sessionAuthenticationStrategy"
		ref="sas" />
	...
</beans:bean>
<beans:bean id="sas"
	class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
	<beans:property name="sessionRegistry" ref="sessionRegistry" />
	<beans:property name="maximumSessions" value="1" />
</beans:bean>
<beans:bean id="sessionRegistry"
	class="org.springframework.security.core.session.SessionRegistryImpl" />  